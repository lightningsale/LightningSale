version: "2.1"

services:
  lnd:
    image: lightningsale/docker-lnd
    build:
      context: ../
      dockerfile: docker/lnd/Dockerfile
    environment:
      - RPCUSER=lightningsale
      - RPCPASS=lightningsale
      - NETWORK=testnet
      - CHAIN=bitcoin
      - DEBUG=info
      - EXTERNALIP=127.0.0.1
    volumes:
      - lnd:/root/.lnd
    ports:
      - 9735:9735
    expose: ["10009", "8080"]
    entrypoint: ["./start-lnd.sh"]
    hostname: lnd
    command:
      - "--neutrino.active"
      - "--neutrino.connect=faucet.lightning.community"
      - "--autopilot.active"
      - "--no-macaroons"
  pos:
    build:
      dockerfile: Dockerfile.xdebug
      context: .
    ports:
      - 80:80
    env_file:
      - .env
    depends_on:
      - mysql
      - lnd
    volumes:
      - .:/var/www
      - lnd:/var/www/var/lnd

  mysql:
    image: mysql
    ports:
      - 3307:3306
    environment:
      - MYSQL_ROOT_PASSWORD=abcd1234
volumes:
  lnd: ~